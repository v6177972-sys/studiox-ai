<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StudioX AI | Socio Pro Engine</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;800&display=swap');
        
        :root {
            --primary: #3b82f6;
            --accent: #f59e0b;
            --bg: #050505;
        }

        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background-color: var(--bg);
            color: #e2e8f0;
            user-select: none;
        }

        .glass {
            background: rgba(15, 15, 15, 0.85);
            backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.08);
        }

        .strategy-card {
            background: linear-gradient(145deg, #111111, #080808);
            border: 1px solid #222;
            border-radius: 24px;
            transition: all 0.3s ease;
        }

        .glow-blue { box-shadow: 0 0 20px rgba(59, 130, 246, 0.2); }
        .glow-amber { box-shadow: 0 0 20px rgba(245, 158, 11, 0.2); }

        .loader {
            border: 3px solid rgba(255,255,255,0.1);
            border-top: 3px solid var(--primary);
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        .tab-active {
            color: white;
            border-bottom: 3px solid var(--primary);
        }
    </style>
</head>
<body class="min-h-screen pb-28">

    <!-- Navbar -->
    <nav class="glass sticky top-0 z-50 p-5 flex justify-between items-center">
        <div class="flex items-center gap-3">
            <div class="w-10 h-10 bg-blue-600 rounded-xl flex items-center justify-center shadow-lg shadow-blue-900/40">
                <i class="fas fa-robot text-white text-lg"></i>
            </div>
            <div>
                <h1 class="font-black text-lg leading-none tracking-tighter">STUDIOX<span class="text-blue-500">AI</span></h1>
                <p class="text-[9px] font-bold text-gray-500 uppercase tracking-widest mt-1">Socio Pro Engine</p>
            </div>
        </div>
        <div class="flex items-center gap-2 bg-black/40 px-3 py-1.5 rounded-full border border-white/5">
            <span class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></span>
            <span class="text-[10px] font-black text-gray-400">v2.5 PRO</span>
        </div>
    </nav>

    <main class="max-w-xl mx-auto p-5">
        
        <!-- Tab Switcher -->
        <div class="flex gap-4 mb-8">
            <button onclick="switchTab('text')" id="tab-text" class="flex-1 py-3 font-extrabold text-sm tracking-widest tab-active transition-all">
                <i class="fas fa-file-alt mr-2"></i>COPYWRITING
            </button>
            <button onclick="switchTab('image')" id="tab-image" class="flex-1 py-3 font-extrabold text-sm tracking-widest text-gray-500 transition-all">
                <i class="fas fa-wand-magic-sparkles mr-2"></i>GRAFICA
            </button>
        </div>

        <!-- Sezione TESTO (Motore Originale) -->
        <section id="section-text" class="space-y-6">
            <div class="glass p-6 rounded-3xl glow-blue">
                <label class="text-[10px] font-black text-blue-500 uppercase tracking-[0.2em] mb-4 block">Obiettivo Campagna</label>
                <textarea id="promptText" rows="3" 
                    class="w-full bg-transparent border-none text-xl font-medium focus:ring-0 placeholder-gray-800 resize-none text-white"
                    placeholder="Esempio: Post per vendere un microfono da podcast a chi inizia ora..."></textarea>
                
                <button onclick="generateText()" id="btnText" 
                    class="w-full mt-6 bg-blue-600 hover:bg-blue-700 text-white font-black py-4 rounded-2xl flex items-center justify-center gap-3 transition-all">
                    <span>GENERA STRATEGIE PRO</span>
                    <i class="fas fa-bolt"></i>
                </button>
            </div>

            <div id="loadingText" class="hidden py-10 text-center">
                <div class="loader mx-auto mb-4"></div>
                <p class="text-sm font-bold text-gray-500 animate-pulse">L'IA sta elaborando i piani virali...</p>
            </div>

            <div id="resultsContainer" class="space-y-6"></div>
        </section>

        <!-- Sezione IMMAGINE (Fix Errore) -->
        <section id="section-image" class="hidden space-y-6">
            <div class="glass p-6 rounded-3xl glow-amber border-amber-500/10">
                <label class="text-[10px] font-black text-amber-500 uppercase tracking-[0.2em] mb-4 block">Visual Prompt</label>
                <textarea id="promptImage" rows="3" 
                    class="w-full bg-transparent border-none text-xl font-medium focus:ring-0 placeholder-gray-800 resize-none text-white"
                    placeholder="Esempio: Un set da podcast moderno, luci neon blu e rosa, stile ultra-realistico..."></textarea>
                
                <button onclick="generateImage()" id="btnImage" 
                    class="w-full mt-6 bg-amber-500 hover:bg-amber-600 text-black font-black py-4 rounded-2xl flex items-center justify-center gap-3 transition-all">
                    <span>CREA IMMAGINE AI</span>
                    <i class="fas fa-palette"></i>
                </button>
            </div>

            <div id="loadingImage" class="hidden py-10 text-center">
                <div class="loader mx-auto mb-4 !border-t-amber-500"></div>
                <p class="text-sm font-bold text-gray-500 animate-pulse">Generazione grafica in corso...</p>
            </div>

            <div id="imageResult" class="hidden">
                <div class="glass p-3 rounded-[32px] overflow-hidden">
                    <img id="outputImage" src="" class="w-full h-auto rounded-[24px] shadow-2xl bg-gray-900" alt="Generated">
                    <div class="p-4 flex gap-3">
                        <button onclick="downloadImage()" class="flex-1 bg-white/5 hover:bg-white/10 py-4 rounded-2xl font-bold text-xs uppercase tracking-widest transition-all">
                            <i class="fas fa-download mr-2"></i>Salva
                        </button>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <!-- Bottom Action -->
    <div class="fixed bottom-6 left-5 right-5 z-50">
        <div class="glass p-4 rounded-[28px] flex items-center justify-between border-blue-500/20 shadow-2xl">
            <div class="flex items-center gap-3">
                <div class="w-10 h-10 bg-amber-500/10 rounded-full flex items-center justify-center">
                    <i class="fas fa-crown text-amber-500"></i>
                </div>
                <div>
                    <p class="text-[9px] font-black text-gray-500 uppercase tracking-tighter">Creator Status</p>
                    <p class="text-xs font-black text-white">TOOLKIT & BONUS ATTIVI</p>
                </div>
            </div>
            <a href="hub.html" class="bg-blue-600 text-white px-6 py-3 rounded-2xl text-[10px] font-black uppercase tracking-widest shadow-lg shadow-blue-600/30">
                HUB PRO
            </a>
        </div>
    </div>

    <script>
        const apiKey = ""; // Gestita internamente

        function switchTab(type) {
            const tText = document.getElementById('tab-text');
            const tImage = document.getElementById('tab-image');
            const sText = document.getElementById('section-text');
            const sImage = document.getElementById('section-image');

            if (type === 'text') {
                tText.classList.add('tab-active'); tText.classList.remove('text-gray-500');
                tImage.classList.remove('tab-active'); tImage.classList.add('text-gray-500');
                sText.classList.remove('hidden'); sImage.classList.add('hidden');
            } else {
                tImage.classList.add('tab-active'); tImage.classList.remove('text-gray-500');
                tText.classList.remove('tab-active'); tText.classList.add('text-gray-500');
                sImage.classList.remove('hidden'); sText.classList.add('hidden');
            }
        }

        async function generateText() {
            const prompt = document.getElementById('promptText').value;
            if (!prompt) return;

            const btn = document.getElementById('btnText');
            const loader = document.getElementById('loadingText');
            const container = document.getElementById('resultsContainer');

            btn.disabled = true;
            loader.classList.remove('hidden');
            container.innerHTML = '';

            const systemPrompt = `Sei StudioX AI. Genera 3 Strategie Social complete. 
            Ogni strategia deve avere:
            1. TITOLO (es. Strategia #1: L'Effetto Urgenza)
            2. HOOK (Il gancio per fermare lo scrolling)
            3. CORPO (Il testo del post ottimizzato)
            4. CTA (Cosa deve fare l'utente)
            5. HASHTAG (5 tag virali)
            Usa un tono persuasivo, professionale e orientato alle vendite. Separa le strategie con ---`;

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: prompt }] }],
                        systemInstruction: { parts: [{ text: systemPrompt }] }
                    })
                });
                const data = await response.json();
                const text = data.candidates[0].content.parts[0].text;
                
                const strategies = text.split('---');
                strategies.forEach((s, i) => {
                    const card = document.createElement('div');
                    card.className = 'strategy-card p-6 space-y-4';
                    card.innerHTML = `
                        <div class="text-xs font-black text-blue-500 uppercase tracking-widest">Opzione ${i+1}</div>
                        <div class="text-gray-300 text-sm leading-relaxed whitespace-pre-wrap">${s.trim()}</div>
                        <button onclick="copyText(this)" class="w-full bg-white/5 py-3 rounded-xl text-[10px] font-black uppercase tracking-widest hover:bg-white/10 transition-all">
                            Copia Copy
                        </button>
                    `;
                    container.appendChild(card);
                });
            } catch (e) {
                alert("Errore di connessione. Riprova.");
            } finally {
                btn.disabled = false;
                loader.classList.add('hidden');
            }
        }

        async function generateImage() {
            const prompt = document.getElementById('promptImage').value;
            if (!prompt) return;

            const btn = document.getElementById('btnImage');
            const loader = document.getElementById('loadingImage');
            const resultDiv = document.getElementById('imageResult');
            const outputImg = document.getElementById('outputImage');

            btn.disabled = true;
            loader.classList.remove('hidden');
            resultDiv.classList.add('hidden');

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/imagen-4.0-generate-001:predict?key=${apiKey}`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        instances: [{ prompt: prompt }],
                        parameters: { sampleCount: 1 }
                    })
                });
                const data = await response.json();
                
                if (data.predictions && data.predictions[0]) {
                    outputImg.src = `data:image/png;base64,${data.predictions[0].bytesBase64Encoded}`;
                    resultDiv.classList.remove('hidden');
                } else {
                    throw new Error("No image");
                }
            } catch (e) {
                alert("Errore Generazione Immagine. Riprova con un prompt diverso.");
            } finally {
                btn.disabled = false;
                loader.classList.add('hidden');
            }
        }

        function copyText(btn) {
            const text = btn.previousElementSibling.innerText;
            navigator.clipboard.writeText(text);
            const original = btn.innerText;
            btn.innerText = "COPIATO âœ…";
            btn.classList.add('bg-green-600/20', 'text-green-500');
            setTimeout(() => {
                btn.innerText = original;
                btn.classList.remove('bg-green-600/20', 'text-green-500');
            }, 2000);
        }

        function downloadImage() {
            const a = document.createElement('a');
            a.href = document.getElementById('outputImage').src;
            a.download = `studiox-ai-${Date.now()}.png`;
            a.click();
        }
    </script>
</body>
</html>

