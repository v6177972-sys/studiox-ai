<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StudioX AI Pro - Generatore Reale</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #050505; color: white; scroll-behavior: smooth; }
        .glass { background: rgba(15, 15, 15, 0.8); backdrop-filter: blur(12px); border: 1px solid rgba(255,255,255,0.1); }
        .neon-border { position: relative; }
        .neon-border::before {
            content: ""; position: absolute; top: 0; left: 0; width: 100%; height: 1px;
            background: linear-gradient(90deg, transparent, #2563eb, transparent);
            opacity: 0.5;
        }
        .result-box { background: rgba(255, 255, 255, 0.03); border: 1px dashed rgba(255,255,255,0.1); }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .animate-result { animation: fadeIn 0.5s ease-out forwards; }
    </style>
</head>
<body class="selection:bg-blue-500/30">

    <nav class="border-b border-white/10 bg-black/50 sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 h-16 flex items-center justify-between">
            <div class="flex items-center gap-2">
                <div class="w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center shadow-[0_0_15px_rgba(37,99,235,0.5)]">
                    <span class="font-bold text-xl text-white">X</span>
                </div>
                <span class="font-bold text-xl tracking-tight uppercase">StudioX <span class="text-blue-500">AI</span></span>
            </div>
            <span class="bg-blue-500/10 text-blue-400 text-[10px] font-bold px-2 py-1 rounded-full border border-blue-500/20 uppercase">Pro Live</span>
        </div>
    </nav>

    <main class="max-w-4xl mx-auto px-4 py-12 md:py-20">
        
        <div class="text-center mb-12">
            <h1 class="text-4xl md:text-6xl font-extrabold mb-6">Genera con <span class="text-blue-500 text-glow">Google Pro</span></h1>
            <p class="text-gray-400 text-lg max-w-2xl mx-auto">Inserisci un prompt e guarda la magia. L'IA creerà contenuti pronti per essere pubblicati.</p>
        </div>

        <div class="glass rounded-3xl p-6 md:p-10 shadow-2xl mb-8 neon-border">
            <!-- Tab Selector -->
            <div class="flex gap-2 mb-8 p-1 bg-black/40 rounded-xl w-fit">
                <button id="tab-text" onclick="setMode('text')" class="mode-btn px-6 py-2 rounded-lg bg-blue-600 text-white font-semibold text-sm transition-all flex items-center gap-2">
                    <i data-lucide="message-square" class="w-4 h-4"></i> Post & Blog
                </button>
                <button id="tab-image" onclick="setMode('image')" class="mode-btn px-6 py-2 rounded-lg text-gray-500 hover:text-white font-semibold text-sm transition-all flex items-center gap-2">
                    <i data-lucide="image" class="w-4 h-4"></i> Grafica AI
                </button>
            </div>

            <div class="space-y-6">
                <textarea id="prompt-input" 
                    placeholder="Esempio: Scrivi un post virale per TikTok che parla di come guadagnare con l'IA..." 
                    class="w-full h-40 bg-black/40 border border-white/10 rounded-2xl p-6 text-lg focus:outline-none focus:ring-2 focus:ring-blue-500/50 transition-all placeholder:text-gray-600 resize-none"></textarea>
                
                <div class="flex justify-between items-center">
                    <p id="status-text" class="text-xs text-gray-500 italic"></p>
                    <button id="generate-btn" class="bg-blue-600 hover:bg-blue-500 p-5 rounded-2xl transition-all hover:scale-105 active:scale-95 shadow-[0_0_25px_rgba(37,99,235,0.4)] flex items-center gap-3">
                        <span class="font-bold uppercase tracking-widest text-sm">Genera</span>
                        <i data-lucide="zap" class="w-5 h-5"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- AREA RISULTATI -->
        <div id="result-container" class="hidden animate-result space-y-6 mb-12">
            <div class="flex items-center gap-3 mb-4">
                <i data-lucide="cpu" class="w-5 h-5 text-blue-500"></i>
                <h2 class="text-xl font-bold">Risultato Elaborazione</h2>
            </div>
            
            <!-- Risultato Testo -->
            <div id="text-result" class="hidden result-box rounded-2xl p-6 text-gray-200 leading-relaxed whitespace-pre-wrap"></div>
            
            <!-- Risultato Immagine -->
            <div id="image-result" class="hidden">
                <img id="generated-img" src="" alt="AI Generated" class="w-full rounded-2xl border border-white/10 shadow-2xl">
            </div>

            <button onclick="copyToClipboard()" class="flex items-center gap-2 text-sm text-blue-400 hover:text-blue-300 transition-colors">
                <i data-lucide="copy" class="w-4 h-4"></i> Copia contenuto
            </button>
        </div>

        <!-- AFFILIAZIONE -->
        <div class="bg-gradient-to-br from-blue-900/20 to-indigo-900/20 border border-blue-500/30 rounded-2xl p-8 mb-20">
            <h3 class="text-xl font-bold mb-2 flex items-center gap-2">
                <i data-lucide="gift" class="text-blue-400"></i> Bonus Partner Esclusivo
            </h3>
            <p class="text-gray-400 mb-6 text-sm">Usa il codice StudioX per sbloccare 500€ di credito pubblicitario per i tuoi nuovi profili.</p>
            <a href="#" class="inline-block bg-blue-600 hover:bg-blue-500 text-white font-bold py-3 px-8 rounded-xl transition-all">Attiva Bonus Ora</a>
        </div>

    </main>

    <script>
        lucide.createIcons();
        
        let currentMode = 'text';
        const apiKey = ""; // API Key gestita dall'ambiente

        function setMode(mode) {
            currentMode = mode;
            document.querySelectorAll('.mode-btn').forEach(b => b.classList.replace('bg-blue-600', 'text-gray-500'));
            document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('text-white'));
            
            const activeBtn = mode === 'text' ? document.getElementById('tab-text') : document.getElementById('tab-image');
            activeBtn.classList.replace('text-gray-500', 'bg-blue-600');
            activeBtn.classList.add('text-white');
            
            document.getElementById('prompt-input').placeholder = mode === 'text' 
                ? "Esempio: Scrivi un post virale per TikTok..." 
                : "Esempio: Un ritratto cyberpunk di un robot in 4k...";
        }

        async function fetchWithRetry(url, options, retries = 5, backoff = 1000) {
            try {
                const response = await fetch(url, options);
                if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                return await response.json();
            } catch (error) {
                if (retries > 0) {
                    await new Promise(resolve => setTimeout(resolve, backoff));
                    return fetchWithRetry(url, options, retries - 1, backoff * 2);
                }
                throw error;
            }
        }

        document.getElementById('generate-btn').addEventListener('click', async () => {
            const prompt = document.getElementById('prompt-input').value;
            const btn = document.getElementById('generate-btn');
            const status = document.getElementById('status-text');
            const resultContainer = document.getElementById('result-container');
            
            if (!prompt) return;

            // UI Loading State
            btn.disabled = true;
            btn.innerHTML = '<div class="w-6 h-6 border-2 border-white/30 border-t-white rounded-full animate-spin"></div>';
            status.innerText = "L'IA sta elaborando la tua richiesta...";
            resultContainer.classList.add('hidden');

            try {
                if (currentMode === 'text') {
                    const result = await fetchWithRetry(
                        `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`,
                        {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
                        }
                    );
                    
                    const text = result.candidates?.[0]?.content?.parts?.[0]?.text;
                    document.getElementById('text-result').innerText = text;
                    document.getElementById('text-result').classList.remove('hidden');
                    document.getElementById('image-result').classList.add('hidden');
                } else {
                    const result = await fetchWithRetry(
                        `https://generativelanguage.googleapis.com/v1beta/models/imagen-4.0-generate-001:predict?key=${apiKey}`,
                        {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ instances: { prompt: prompt }, parameters: { sampleCount: 1 } })
                        }
                    );
                    
                    const imageUrl = `data:image/png;base64,${result.predictions[0].bytesBase64Encoded}`;
                    document.getElementById('generated-img').src = imageUrl;
                    document.getElementById('image-result').classList.remove('hidden');
                    document.getElementById('text-result').classList.add('hidden');
                }

                resultContainer.classList.remove('hidden');
                status.innerText = "Generazione completata!";
                window.scrollTo(0, document.body.scrollHeight);
            } catch (error) {
                status.innerText = "Errore durante la generazione. Riprova tra un istante.";
                console.error(error);
            } finally {
                btn.disabled = false;
                btn.innerHTML = '<span class="font-bold uppercase tracking-widest text-sm">Genera</span><i data-lucide="zap" class="w-5 h-5"></i>';
                lucide.createIcons();
            }
        });

        function copyToClipboard() {
            const text = document.getElementById('text-result').innerText;
            const el = document.createElement('textarea');
            el.value = text;
            document.body.appendChild(el);
            el.select();
            document.execCommand('copy');
            document.body.removeChild(el);
            alert("Contenuto copiato negli appunti!");
        }
    </script>
</body>
</html>

